<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mars Maps - Navigation Helper</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            font-family: 'Arial', sans-serif;
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .header {
            text-align: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .maps-container {
            position: relative;
            width: 100%;
            height: calc(100vh - 120px);
            border: 3px solid rgba(255, 165, 0, 0.5);
            border-radius: 10px;
            margin: 10px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .maps-iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 7px;
        }
        
        .mars-icon {
            font-size: 2rem;
            margin-right: 0.5rem;
            animation: float 3s ease-in-out infinite;
            display: inline-block;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }
        
        h1 {
            font-size: 2rem;
            margin: 0.5rem 0;
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: inline-block;
        }
        
        .subtitle {
            font-size: 1rem;
            opacity: 0.8;
            margin-bottom: 0.5rem;
        }
        
        .controls {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 8px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .control-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);
        }
        
        .premium-only {
            background: linear-gradient(45deg, #FFD700, #FFA500) !important;
            color: #000 !important;
            border: 2px solid rgba(255, 215, 0, 0.5);
            animation: premiumGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes premiumGlow {
            from { box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3); }
            to { box-shadow: 0 4px 16px rgba(255, 215, 0, 0.6); }
        }
        
        .premium-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(50, 50, 50, 0.95));
            padding: 30px;
            border-radius: 20px;
            border: 2px solid rgba(255, 215, 0, 0.8);
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.3);
            color: white;
            z-index: 10000;
            max-width: 500px;
            width: 90%;
            backdrop-filter: blur(20px);
            display: none;
        }
        
        .premium-panel h3 {
            color: #FFD700;
            text-align: center;
            margin-bottom: 20px;
            font-size: 24px;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 215, 0, 0.3);
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .feature-card:hover {
            background: rgba(255, 215, 0, 0.2);
            transform: translateY(-2px);
        }
        
        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            color: #FFD700;
            font-size: 24px;
            cursor: pointer;
        }
        
        .back-button {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background-color: rgba(108, 117, 125, 0.9);
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            font-family: Arial, sans-serif;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 1000;
        }
        
        .back-button:hover {
            background-color: rgba(108, 117, 125, 1);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        .external-link {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            color: white;
            text-decoration: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 1000;
        }
        
        .external-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(255, 107, 107, 0.4);
        }
        
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }
        
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 2s infinite;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.2; }
            50% { opacity: 0.8; }
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>
    
    <div class="header">
        <div class="mars-icon">ü™ê</div>
        <div class="search-container" style="
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        ">
            <input type="text" id="searchBar" placeholder="üöÄ Premium Search: Multi-destination, coordinates, or voice commands..." style="
                flex: 1;
                max-width: 500px;
                padding: 12px 20px;
                font-size: 16px;
                border: 2px solid rgba(255, 215, 0, 0.6);
                border-radius: 25px;
                background: linear-gradient(45deg, rgba(0, 0, 0, 0.8), rgba(50, 50, 50, 0.8));
                color: white;
                outline: none;
                backdrop-filter: blur(10px);
                transition: all 0.3s ease;
                box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            " onkeypress="handleSearch(event)" oninput="showSuggestions(this.value)" onfocus="this.style.borderColor='rgba(255, 215, 0, 0.9)'; this.style.boxShadow='0 0 30px rgba(255, 215, 0, 0.5)'" onblur="hideSuggestions(); this.style.borderColor='rgba(255, 215, 0, 0.6)'; this.style.boxShadow='0 0 20px rgba(255, 215, 0, 0.3)'">>
            
            <!-- Suggestions Dropdown -->
            <div id="suggestions" style="
                position: absolute;
                top: 100%;
                left: 0;
                right: 80px;
                background: rgba(0, 0, 0, 0.9);
                border-radius: 15px;
                margin-top: 5px;
                max-height: 200px;
                overflow-y: auto;
                display: none;
                z-index: 1000;
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 165, 0, 0.3);
            "></div>
            <button id="voiceBtn" onclick="startVoiceSearch()" style="
                background: linear-gradient(45deg, #e91e63, #ad1457);
                color: white;
                border: none;
                padding: 12px 16px;
                border-radius: 25px;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 5px;
                box-shadow: 0 2px 8px rgba(233, 30, 99, 0.3);
            " onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 4px 12px rgba(233, 30, 99, 0.5)'" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 8px rgba(233, 30, 99, 0.3)'">
                üé§ Voice
            </button>
            <button id="multiDestBtn" onclick="toggleMultiDestination()" style="
                background: linear-gradient(45deg, #673ab7, #512da8);
                color: white;
                border: none;
                padding: 12px 16px;
                border-radius: 25px;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 5px;
                box-shadow: 0 2px 8px rgba(103, 58, 183, 0.3);
            " onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 4px 12px rgba(103, 58, 183, 0.5)'" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 8px rgba(103, 58, 183, 0.3)'">
                üó∫Ô∏è Multi
            </button>
            <button id="searchBtn" onclick="performSearch()" style="
                background: linear-gradient(45deg, #ff6b6b, #ffa500);
                color: white;
                border: none;
                padding: 12px 20px;
                border-radius: 25px;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 5px;
                box-shadow: 0 2px 8px rgba(255, 107, 107, 0.3);
            " onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 4px 12px rgba(255, 107, 107, 0.5)'" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 8px rgba(255, 107, 107, 0.3)'">
                üîç Premium Route
            </button>
            <button id="aiPlannerBtn" onclick="openAIPlanner()" style="
                background: linear-gradient(45deg, #00bcd4, #0097a7);
                color: white;
                border: none;
                padding: 12px 20px;
                border-radius: 25px;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 5px;
                box-shadow: 0 2px 8px rgba(0, 188, 212, 0.3);
            " onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 4px 12px rgba(0, 188, 212, 0.5)'" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 8px rgba(0, 188, 212, 0.3)'">
                ü§ñ AI Planner
            </button>
            <button id="navigateBtn" onclick="navigateToLastSearch()" style="
                background: linear-gradient(45deg, #4CAF50, #45a049);
                color: white;
                border: none;
                padding: 12px 20px;
                border-radius: 25px;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 5px;
                box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
                opacity: 0.6;
            " onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 4px 12px rgba(76, 175, 80, 0.5)'" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 8px rgba(76, 175, 80, 0.3)'">
                üß≠ Navigate
            </button>
            <button id="viewPointsBtn" onclick="showPointsList()" style="
                background: linear-gradient(45deg, #9C27B0, #7B1FA2);
                color: white;
                border: none;
                padding: 12px 20px;
                border-radius: 25px;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 5px;
                box-shadow: 0 2px 8px rgba(156, 39, 176, 0.3);
                opacity: 0.6;
            " onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 4px 12px rgba(156, 39, 176, 0.5)'" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 8px rgba(156, 39, 176, 0.3)'">
                üìã Points
            </button>
            <button id="analyticsBtn" onclick="showAnalytics()" style="
                background: linear-gradient(45deg, #ff9800, #f57c00);
                color: white;
                border: none;
                padding: 12px 20px;
                border-radius: 25px;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 5px;
                box-shadow: 0 2px 8px rgba(255, 152, 0, 0.3);
            " onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 4px 12px rgba(255, 152, 0, 0.5)'" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 8px rgba(255, 152, 0, 0.3)'">
                üìä Analytics
            </button>
            <button id="signOutBtn" onclick="signOut()" style="
                background: linear-gradient(45deg, #dc3545, #c82333);
                color: white;
                border: none;
                padding: 12px 20px;
                border-radius: 25px;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 5px;
                box-shadow: 0 2px 8px rgba(220, 53, 69, 0.3);
                border: 2px solid rgba(220, 53, 69, 0.5);
            " onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 4px 12px rgba(220, 53, 69, 0.6)'; this.style.borderColor='rgba(220, 53, 69, 0.8)'" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 8px rgba(220, 53, 69, 0.3)'; this.style.borderColor='rgba(220, 53, 69, 0.5)'">
                üö™ Sign Out
            </button>
        </div>
        
        <!-- Status Indicator -->
        <div id="statusIndicator" style="
            text-align: center;
            margin: 10px auto;
            padding: 8px 16px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 20px;
            color: #ffa500;
            font-size: 14px;
            font-weight: bold;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 165, 0, 0.3);
            max-width: 400px;
            opacity: 0;
            transition: all 0.3s ease;
        ">
            üó∫Ô∏è Ready for navigation
        </div>
        <div class="subtitle">Search and navigate across the galaxy</div>
    </div>
    
    <div class="maps-container">
        <div class="controls">
            <button class="control-btn" onclick="setMapMode('roadmap')">üó∫Ô∏è Road</button>
            <button class="control-btn" onclick="setMapMode('satellite')">üõ∞Ô∏è Satellite</button>
            <button class="control-btn" onclick="setMapMode('hybrid')">üåç Hybrid</button>
            <button class="control-btn" onclick="setMapMode('terrain')">üèîÔ∏è Terrain</button>
            <button class="control-btn premium-only" onclick="setMapMode('street')">üèôÔ∏è Street View</button>
            <button class="control-btn premium-only" onclick="setMapMode('night')">üåô Night Mode</button>
            <button class="control-btn" onclick="findLocation()">üìç Find Me</button>
            <button class="control-btn premium-only" onclick="trackLocation()">üì° Live Track</button>
            <button class="control-btn" onclick="navigateFromMyLocation()">üß≠ Navigate</button>
            <button class="control-btn premium-only" onclick="optimizeRoute()">‚ö° Optimize</button>
            <button class="control-btn" onclick="toggleAddPointMode()" id="addPointBtn">üìå Add Point</button>
            <button class="control-btn premium-only" onclick="shareLocation()">üì§ Share</button>
            <button class="control-btn premium-only" onclick="offlineMode()">üì± Offline</button>
            <button class="control-btn premium-only" onclick="weatherOverlay()">üå§Ô∏è Weather</button>
            <button class="control-btn premium-only" onclick="trafficLive()">üö¶ Live Traffic</button>
        </div>
        <iframe id="mapsFrame" class="maps-iframe" 
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d387190.2799160891!2d-74.25987368715491!3d40.697670064001676!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89c24fa5d33f083b%3A0xc80b8f06e177fe62!2sNew%20York%2C%20NY%2C%20USA!5e0!3m2!1sen!2sus!4v1691234567890!5m2!1sen!2sus"
                allowfullscreen="" 
                loading="lazy" 
                referrerpolicy="no-referrer-when-downgrade">
        </iframe>
    </div>
    
    <a href="marksnav.html" class="back-button">
        ‚Üê Back to Navigation
    </a>
    
    <a href="https://maps.google.com" target="_blank" class="external-link">
        üöÄ Open Full Maps
    </a>
    
    <!-- Premium AI Planner Panel -->
    <div id="aiPlannerPanel" class="premium-panel">
        <button class="close-btn" onclick="closePanel('aiPlannerPanel')">&times;</button>
        <h3>ü§ñ AI Trip Planner</h3>
        <div class="feature-grid">
            <div class="feature-card" onclick="optimizedTrip()">
                <h4>‚ö° Optimized Routes</h4>
                <p>AI calculates fastest paths</p>
            </div>
            <div class="feature-card" onclick="smartRecommendations()">
                <h4>üß† Smart Suggestions</h4>
                <p>Personalized recommendations</p>
            </div>
            <div class="feature-card" onclick="predictiveTraffic()">
                <h4>üîÆ Traffic Prediction</h4>
                <p>Future traffic analysis</p>
            </div>
            <div class="feature-card" onclick="weatherIntegration()">
                <h4>üå§Ô∏è Weather Planning</h4>
                <p>Weather-aware routing</p>
            </div>
        </div>
    </div>
    
    <!-- Premium Multi-Destination Panel -->
    <div id="multiDestPanel" class="premium-panel">
        <button class="close-btn" onclick="closePanel('multiDestPanel')">&times;</button>
        <h3>üó∫Ô∏è Multi-Destination Planner</h3>
        <div id="destinationList" style="margin: 20px 0;">
            <div style="margin-bottom: 10px;">
                <input type="text" placeholder="üöÄ Destination 1" style="width: 100%; padding: 10px; border-radius: 10px; border: 1px solid #FFD700; background: rgba(0,0,0,0.7); color: white;">
            </div>
            <div style="margin-bottom: 10px;">
                <input type="text" placeholder="üõ∏ Destination 2" style="width: 100%; padding: 10px; border-radius: 10px; border: 1px solid #FFD700; background: rgba(0,0,0,0.7); color: white;">
            </div>
        </div>
        <button onclick="addDestination()" style="background: linear-gradient(45deg, #4CAF50, #45a049); color: white; border: none; padding: 10px 20px; border-radius: 10px; margin: 5px;">‚ûï Add Destination</button>
        <button onclick="planMultiRoute()" style="background: linear-gradient(45deg, #FFD700, #FFA500); color: black; border: none; padding: 10px 20px; border-radius: 10px; margin: 5px;">üó∫Ô∏è Plan Route</button>
    </div>
    
    <!-- Premium Analytics Panel -->
    <div id="analyticsPanel" class="premium-panel">
        <button class="close-btn" onclick="closePanel('analyticsPanel')">&times;</button>
        <h3>üìä Travel Analytics</h3>
        <div class="feature-grid">
            <div class="feature-card">
                <h4>üìà Distance Traveled</h4>
                <p id="totalDistance">1,247 km this month</p>
            </div>
            <div class="feature-card">
                <h4>‚è±Ô∏è Time Saved</h4>
                <p id="timeSaved">3.5 hours with premium routes</p>
            </div>
            <div class="feature-card">
                <h4>üí∞ Fuel Saved</h4>
                <p id="fuelSaved">$127 saved this month</p>
            </div>
            <div class="feature-card">
                <h4>üå± CO2 Reduced</h4>
                <p id="co2Saved">45 kg CO2 saved</p>
            </div>
        </div>
    </div>
    
    <script>
        // Create animated stars background
        function createStars() {
            const starsContainer = document.getElementById('stars');
            const numStars = 30;
            
            for (let i = 0; i < numStars; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = Math.random() * 2 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.animationDelay = Math.random() * 2 + 's';
                starsContainer.appendChild(star);
            }
        }
        
        // Map control functions
        function setMapMode(mode) {
            const iframe = document.getElementById('mapsFrame');
            let baseUrl = 'https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d387190.2799160891!2d-74.25987368715491!3d40.697670064001676!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89c24fa5d33f083b%3A0xc80b8f06e177fe62!2sNew%20York%2C%20NY%2C%20USA!5e';
            
            switch(mode) {
                case 'satellite':
                    baseUrl += '1';
                    break;
                case 'hybrid':
                    baseUrl += '2';
                    break;
                case 'terrain':
                    baseUrl += '3';
                    break;
                default:
                    baseUrl += '0';
            }
            
            baseUrl += '!3m2!1sen!2sus!4v1691234567890!5m2!1sen!2sus';
            iframe.src = baseUrl;
        }
        
        function findLocation() {
            if (navigator.geolocation) {
                updateStatusIndicator('üìç Getting your location...', '#ffa500');
                navigator.geolocation.getCurrentPosition(function(position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    const iframe = document.getElementById('mapsFrame');
                    iframe.src = `https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d12000!2d${lng}!3d${lat}!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2sus!4v1691234567890!5m2!1sen!2sus`;
                    
                    updateStatusIndicator(`üìç Located! Lat: ${lat.toFixed(4)}, Lng: ${lng.toFixed(4)}`, '#4CAF50');
                    console.log(`üìç Location found: ${lat}, ${lng}`);
                }, function() {
                    updateStatusIndicator('üö® Unable to access location. Please enable location services.', '#ff6b6b');
                    alert('üõ∞Ô∏è Unable to access your location. Please enable location services.');
                });
            } else {
                updateStatusIndicator('üö® Geolocation not supported by browser', '#ff6b6b');
                alert('üöÄ Geolocation is not supported by this browser.');
            }
        }
        
        // Navigation functionality
        let lastSearchedLocation = '';
        let searchHistory = [];
        let locationSuggestions = [
            'New York, NY', 'Los Angeles, CA', 'Chicago, IL', 'Houston, TX', 
            'Phoenix, AZ', 'Philadelphia, PA', 'San Antonio, TX', 'San Diego, CA',
            'Dallas, TX', 'San Jose, CA', 'Austin, TX', 'Jacksonville, FL',
            'Fort Worth, TX', 'Columbus, OH', 'Charlotte, NC', 'San Francisco, CA',
            'Indianapolis, IN', 'Seattle, WA', 'Denver, CO', 'Washington, DC'
        ];
        
        // Add Point functionality
        let addPointMode = false;
        let savedPoints = [];
        let pointCounter = 1;
        
        function navigateFromMyLocation() {
            const searchBar = document.getElementById('searchBar');
            const destination = searchBar.value.trim() || lastSearchedLocation;
            
            if (!destination) {
                alert('ü™ê Please search for a destination first, then click Navigate!');
                return;
            }
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const userLat = position.coords.latitude;
                    const userLng = position.coords.longitude;
                    const iframe = document.getElementById('mapsFrame');
                    const encodedDestination = encodeURIComponent(destination);
                    
                    // Create navigation URL with directions from current location to destination
                    const navigationUrl = `https://www.google.com/maps/embed?pb=!1m28!1m12!1m3!1d50000!2d${userLng}!3d${userLat}!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!4m13!3e0!4m5!1s${userLat},${userLng}!3m2!1d${userLat}!2d${userLng}!4m5!1s${encodedDestination}!3m2!1d0!2d0!5e0!3m2!1sen!2sus!4v1691234567890!5m2!1sen!2sus`;
                    
                    iframe.src = navigationUrl;
                    console.log(`üß≠ Navigation started from your location to: ${destination}`);
                    
                    // Show success message
                    alert(`üöÄ Navigation initiated! Showing route from your location to ${destination}`);
                    
                }, function(error) {
                    console.error('Geolocation error:', error);
                    alert('üõ∞Ô∏è Unable to access your location. Please enable location services for navigation.');
                });
            } else {
                alert('üöÄ Geolocation is not supported by this browser. Navigation requires location access.');
            }
        }
        
        // Handle search functionality
        function handleSearch(event) {
            if (event.key === 'Enter') {
                performSearch();
            }
        }
        
        function performSearch() {
            const searchBar = document.getElementById('searchBar');
            const searchTerm = searchBar.value.trim();
            if (searchTerm) {
                // Store the searched location for navigation
                lastSearchedLocation = searchTerm;
                
                // Update status indicator
                updateStatusIndicator('üîÑ Getting directions...', '#ffa500');
                
                // Show loading indicator
                const searchBtn = document.getElementById('searchBtn');
                const originalText = searchBtn.innerHTML;
                searchBtn.innerHTML = 'üîÑ Finding Route...';
                searchBtn.disabled = true;
                
                // Copy input value and search in Google Maps
                copyToGoogleMapsSearch(searchTerm);
                
                // Enable navigate button
                const navigateBtn = document.getElementById('navigateBtn');
                navigateBtn.style.opacity = '1';
                navigateBtn.style.cursor = 'pointer';
                
                // Add to search history
                addToSearchHistory(searchTerm);
                
                // Reset button after delay
                setTimeout(() => {
                    searchBtn.innerHTML = originalText;
                    searchBtn.disabled = false;
                    updateStatusIndicator(`üß≠ Showing route to: ${searchTerm}`, '#4CAF50');
                }, 2000);
                
                console.log(`üß≠ Getting route to: ${searchTerm}`);
            } else {
                alert('ü™ê Please enter a location to search for!');
            }
        }
        
        function copyToGoogleMapsSearch(destination) {
            const iframe = document.getElementById('mapsFrame');
            const encodedDestination = encodeURIComponent(destination);
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const userLat = position.coords.latitude;
                    const userLng = position.coords.longitude;
                    
                    // Create Google Maps URL with directions from current location to destination
                    const directionsUrl = `https://www.google.com/maps/embed/v1/directions?key=AIzaSyB41DRUbKWJHPxaFjMAwdrzWzbVKartNGg&origin=${userLat},${userLng}&destination=${encodedDestination}&mode=driving`;
                    
                    iframe.src = directionsUrl;
                    
                    console.log(`üß≠ Route from your location (${userLat}, ${userLng}) to: ${destination}`);
                }, function(error) {
                    console.log('Geolocation error:', error);
                    // Fallback: just search for the destination without directions
                    const searchUrl = `https://www.google.com/maps/embed/v1/search?key=AIzaSyB41DRUbKWJHPxaFjMAwdrzWzbVKartNGg&q=${encodedDestination}`;
                    iframe.src = searchUrl;
                    
                    console.log(`üîç Searching for: ${destination} (no geolocation)`);
                });
            } else {
                // Fallback: just search for the destination
                const searchUrl = `https://www.google.com/maps/embed/v1/search?key=AIzaSyB41DRUbKWJHPxaFjMAwdrzWzbVKartNGg&q=${encodedDestination}`;
                iframe.src = searchUrl;
                
                console.log(`üîç Searching for: ${destination} (no geolocation support)`);
            }
        }
        
        function showSuggestions(inputValue) {
            const suggestionsDiv = document.getElementById('suggestions');
            const searchTerm = inputValue.toLowerCase().trim();
            
            if (searchTerm.length < 2) {
                suggestionsDiv.style.display = 'none';
                return;
            }
            
            // Combine search history and location suggestions
            const allSuggestions = [...new Set([...searchHistory, ...locationSuggestions])];
            
            // Filter suggestions based on input
            const filteredSuggestions = allSuggestions.filter(suggestion =>
                suggestion.toLowerCase().includes(searchTerm)
            ).slice(0, 5); // Show only top 5 suggestions
            
            if (filteredSuggestions.length > 0) {
                suggestionsDiv.innerHTML = '';
                filteredSuggestions.forEach(suggestion => {
                    const suggestionItem = document.createElement('div');
                    suggestionItem.style.cssText = `
                        padding: 10px 15px;
                        cursor: pointer;
                        border-bottom: 1px solid rgba(255, 165, 0, 0.2);
                        color: white;
                        font-size: 14px;
                        transition: background-color 0.2s ease;
                    `;
                    suggestionItem.innerHTML = `üìç ${suggestion}`;
                    
                    suggestionItem.onmouseover = function() {
                        this.style.backgroundColor = 'rgba(255, 165, 0, 0.2)';
                    };
                    suggestionItem.onmouseout = function() {
                        this.style.backgroundColor = 'transparent';
                    };
                    suggestionItem.onclick = function() {
                        selectSuggestion(suggestion);
                    };
                    
                    suggestionsDiv.appendChild(suggestionItem);
                });
                
                suggestionsDiv.style.display = 'block';
            } else {
                suggestionsDiv.style.display = 'none';
            }
        }
        
        function hideSuggestions() {
            setTimeout(() => {
                const suggestionsDiv = document.getElementById('suggestions');
                suggestionsDiv.style.display = 'none';
            }, 200); // Delay to allow clicking on suggestions
        }
        
        function selectSuggestion(suggestion) {
            const searchBar = document.getElementById('searchBar');
            searchBar.value = suggestion;
            hideSuggestions();
            searchBar.focus();
        }
        
        function navigateToLastSearch() {
            if (lastSearchedLocation) {
                const navigateBtn = document.getElementById('navigateBtn');
                const originalText = navigateBtn.innerHTML;
                navigateBtn.innerHTML = 'üîÑ Navigating...';
                navigateBtn.disabled = true;
                
                updateStatusIndicator('üîÑ Refreshing navigation...', '#ffa500');
                
                copyToGoogleMapsSearch(lastSearchedLocation);
                
                setTimeout(() => {
                    navigateBtn.innerHTML = originalText;
                    navigateBtn.disabled = false;
                    updateStatusIndicator(`üß≠ Showing route to: ${lastSearchedLocation}`, '#4CAF50');
                }, 2000);
                
                console.log(`üß≠ Re-navigating to: ${lastSearchedLocation}`);
            } else {
                alert('ü™ê Please search for a location first!');
            }
        }
        
        function addToSearchHistory(location) {
            if (!searchHistory.includes(location)) {
                searchHistory.push(location);
                // Keep only last 10 searches
                if (searchHistory.length > 10) {
                    searchHistory.shift();
                }
            }
        }
        
        function updateStatusIndicator(message, color) {
            const indicator = document.getElementById('statusIndicator');
            indicator.innerHTML = message;
            indicator.style.color = color;
            indicator.style.opacity = '1';
        }
        
        function searchLocation(location) {
            const iframe = document.getElementById('mapsFrame');
            const encodedLocation = encodeURIComponent(location);
            
            // First try to get user's current location for proximity search
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const userLat = position.coords.latitude;
                    const userLng = position.coords.longitude;
                    
                    // Search for closest location using user's position as reference
                    const searchUrl = `https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d50000!2d${userLng}!3d${userLat}!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2s${encodedLocation}+near+me!5e0!3m2!1sen!2sus!4v1691234567890!5m2!1sen!2sus`;
                    iframe.src = searchUrl;
                    
                    console.log(`üîç Searching for closest "${location}" near your location`);
                }, function() {
                    // Fallback if geolocation fails
                    performBasicSearch(iframe, encodedLocation, location);
                });
            } else {
                // Fallback if geolocation not supported
                performBasicSearch(iframe, encodedLocation, location);
            }
        }
        
        function getDirectionsToDestination(destination) {
            // This function now uses the simplified approach
            copyToGoogleMapsSearch(destination);
        }
        
        function performBasicSearch(iframe, encodedLocation, location) {
            // Use Google Maps search with general proximity
            const searchUrl = `https://www.google.com/maps/embed/v1/search?key=AIzaSyB41DRUbKWJHPxaFjMAwdrzWzbVKartNGg&q=${encodedLocation}`;
            
            // Fallback to standard embed with search
            iframe.src = `https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d100000!2d0!3d0!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2s${encodedLocation}!5e0!3m2!1sen!2sus!4v1691234567890!5m2!1sen!2sus`;
            
            console.log(`üîç Searching for: ${location} (basic search)`);
        }
        
        // Add Point functionality
        function toggleAddPointMode() {
            const addPointBtn = document.getElementById('addPointBtn');
            
            if (!addPointMode) {
                // Enable add point mode
                addPointMode = true;
                addPointBtn.innerHTML = '‚ùå Cancel Point';
                addPointBtn.style.background = 'linear-gradient(45deg, #ff6b6b, #ff4444)';
                updateStatusIndicator('üìå Click on the map to add a point', '#ffa500');
                
                // Add click listener to iframe (this is limited due to cross-origin restrictions)
                showAddPointInstructions();
            } else {
                // Disable add point mode
                addPointMode = false;
                addPointBtn.innerHTML = 'üìå Add Point';
                addPointBtn.style.background = 'linear-gradient(45deg, #ff6b6b, #ffa500)';
                updateStatusIndicator('üìç Add point mode cancelled', '#6c757d');
            }
        }
        
        function showAddPointInstructions() {
            const pointName = prompt('üöÄ Enter a name for this location point:', `Point ${pointCounter}`);
            
            if (pointName) {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(function(position) {
                        const userLat = position.coords.latitude;
                        const userLng = position.coords.longitude;
                        
                        // Since we can't directly interact with the Google Maps iframe due to cross-origin restrictions,
                        // we'll add the point to our local storage and create a custom overlay
                        addPointToMap(userLat, userLng, pointName);
                        
                    }, function() {
                        // Fallback: let user enter coordinates manually
                        addPointManually(pointName);
                    });
                } else {
                    addPointManually(pointName);
                }
            }
            
            // Reset add point mode
            toggleAddPointMode();
        }
        
        function addPointManually(pointName) {
            const coords = prompt('üìç Enter coordinates (lat,lng) or address:', '40.7128,-74.0060');
            
            if (coords) {
                if (coords.includes(',')) {
                    // Coordinates format
                    const [lat, lng] = coords.split(',').map(coord => parseFloat(coord.trim()));
                    if (!isNaN(lat) && !isNaN(lng)) {
                        addPointToMap(lat, lng, pointName);
                    } else {
                        alert('üö® Invalid coordinates format. Please use: lat,lng');
                    }
                } else {
                    // Address format - geocode it
                    addPointByAddress(coords, pointName);
                }
            }
        }
        
        function addPointByAddress(address, pointName) {
            // Use Google Maps to find coordinates for the address
            const iframe = document.getElementById('mapsFrame');
            const encodedAddress = encodeURIComponent(address);
            
            // For now, we'll add it to our points list and show it in the map URL
            const point = {
                id: pointCounter++,
                name: pointName,
                address: address,
                timestamp: new Date().toLocaleString()
            };
            
            savedPoints.push(point);
            updateStatusIndicator(`üìå Added point: ${pointName} at ${address}`, '#4CAF50');
            
            // Enable Points button
            const viewPointsBtn = document.getElementById('viewPointsBtn');
            viewPointsBtn.style.opacity = '1';
            
            // Update map to show the location
            const mapUrl = `https://www.google.com/maps/embed/v1/search?key=AIzaSyB41DRUbKWJHPxaFjMAwdrzWzbVKartNGg&q=${encodedAddress}`;
            iframe.src = mapUrl;
            
            console.log(`üìå Point added: ${pointName} at ${address}`);
        }
        
        function addPointToMap(lat, lng, pointName) {
            const point = {
                id: pointCounter++,
                name: pointName,
                lat: lat,
                lng: lng,
                timestamp: new Date().toLocaleString()
            };
            
            savedPoints.push(point);
            updateStatusIndicator(`üìå Added point: ${pointName} at ${lat.toFixed(4)}, ${lng.toFixed(4)}`, '#4CAF50');
            
            // Enable Points button
            const viewPointsBtn = document.getElementById('viewPointsBtn');
            viewPointsBtn.style.opacity = '1';
            
            // Update map to show the point
            const iframe = document.getElementById('mapsFrame');
            const mapUrl = `https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d1000!2d${lng}!3d${lat}!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2sus!4v1691234567890!5m2!1sen!2sus`;
            iframe.src = mapUrl;
            
            console.log(`üìå Point added: ${pointName} at ${lat}, ${lng}`);
        }
        
        function showPointsList() {
            if (savedPoints.length > 0) {
                let pointsList = 'üìå Saved Points:\n\n';
                savedPoints.forEach((point, index) => {
                    if (point.lat && point.lng) {
                        pointsList += `${index + 1}. ${point.name} (${point.lat.toFixed(4)}, ${point.lng.toFixed(4)}) - ${point.timestamp}\n`;
                    } else {
                        pointsList += `${index + 1}. ${point.name} (${point.address}) - ${point.timestamp}\n`;
                    }
                });
                
                pointsList += '\nüóëÔ∏è Clear all points?';
                pointsList += '\nüß≠ Navigate to a point? (Enter point number)';
                
                const userChoice = prompt(pointsList, 'Enter action: clear/navigate/number');
                
                if (userChoice) {
                    if (userChoice.toLowerCase() === 'clear') {
                        clearAllPoints();
                    } else if (userChoice.toLowerCase() === 'navigate' || !isNaN(userChoice)) {
                        const pointIndex = isNaN(userChoice) ? 0 : parseInt(userChoice) - 1;
                        if (pointIndex >= 0 && pointIndex < savedPoints.length) {
                            navigateToSavedPoint(savedPoints[pointIndex]);
                        } else {
                            alert('üö® Invalid point number!');
                        }
                    }
                }
            } else {
                updateStatusIndicator('üìã No saved points yet. Use "Add Point" to create some!', '#ffa500');
                alert('üìã No saved points yet.\n\nÔøΩ Use the "Add Point" button to save locations on the map!');
            }
        }
        
        function navigateToSavedPoint(point) {
            if (point.lat && point.lng) {
                // Navigate using coordinates
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(function(position) {
                        const userLat = position.coords.latitude;
                        const userLng = position.coords.longitude;
                        const iframe = document.getElementById('mapsFrame');
                        
                        const directionsUrl = `https://www.google.com/maps/embed/v1/directions?key=AIzaSyB41DRUbKWJHPxaFjMAwdrzWzbVKartNGg&origin=${userLat},${userLng}&destination=${point.lat},${point.lng}&mode=driving`;
                        iframe.src = directionsUrl;
                        
                        updateStatusIndicator(`üß≠ Navigating to: ${point.name}`, '#4CAF50');
                        console.log(`üß≠ Navigating to saved point: ${point.name}`);
                    });
                } else {
                    // Just show the point location
                    const iframe = document.getElementById('mapsFrame');
                    iframe.src = `https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d1000!2d${point.lng}!3d${point.lat}!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2sus!4v1691234567890!5m2!1sen!2sus`;
                    updateStatusIndicator(`üìç Showing: ${point.name}`, '#4CAF50');
                }
            } else {
                // Navigate using address
                copyToGoogleMapsSearch(point.address);
                updateStatusIndicator(`üß≠ Navigating to: ${point.name}`, '#4CAF50');
            }
        }
        
        function clearAllPoints() {
            savedPoints = [];
            pointCounter = 1;
            updateStatusIndicator('üóëÔ∏è All saved points cleared', '#6c757d');
            
            // Disable Points button
            const viewPointsBtn = document.getElementById('viewPointsBtn');
            viewPointsBtn.style.opacity = '0.6';
            
            console.log('üóëÔ∏è All points cleared');
        }
        
        function signOut() {
            updateStatusIndicator('üö™ Signing out of premium...', '#dc3545');
            
            // Show confirmation dialog
            const confirmSignOut = confirm('üöÄ Are you sure you want to sign out of Mars Maps Premium?\n\nYou will be redirected to the standard maps view.');
            
            if (confirmSignOut) {
                // Show signing out message
                alert('üõ∞Ô∏è Thank you for using Mars Maps Premium!\n\nRedirecting to standard navigation...');
                
                // Redirect to mars-maps.html in nav folder
                window.location.href = '../mars-maps.html';
                
                console.log('üö™ User signed out of premium');
            } else {
                updateStatusIndicator('üõ∞Ô∏è Sign out cancelled', '#4CAF50');
                console.log('üö™ Sign out cancelled');
            }
        }
        
        // Premium Features
        let isListening = false;
        let multiDestMode = false;
        let destinations = [];
        
        function startVoiceSearch() {
            if ('webkitSpeechRecognition' in window) {
                const recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'en-US';
                
                const voiceBtn = document.getElementById('voiceBtn');
                
                if (!isListening) {
                    recognition.start();
                    isListening = true;
                    voiceBtn.innerHTML = 'üî¥ Listening...';
                    voiceBtn.style.background = 'linear-gradient(45deg, #f44336, #d32f2f)';
                    updateStatusIndicator('üé§ Voice command active - speak now!', '#e91e63');
                    
                    recognition.onresult = function(event) {
                        const transcript = event.results[0][0].transcript;
                        document.getElementById('searchBar').value = transcript;
                        updateStatusIndicator(`üé§ Voice: "${transcript}"`, '#4CAF50');
                        performSearch();
                    };
                    
                    recognition.onerror = function(event) {
                        updateStatusIndicator('üö® Voice recognition error', '#f44336');
                        isListening = false;
                        voiceBtn.innerHTML = 'üé§ Voice';
                        voiceBtn.style.background = 'linear-gradient(45deg, #e91e63, #ad1457)';
                    };
                    
                    recognition.onend = function() {
                        isListening = false;
                        voiceBtn.innerHTML = 'üé§ Voice';
                        voiceBtn.style.background = 'linear-gradient(45deg, #e91e63, #ad1457)';
                    };
                } else {
                    recognition.stop();
                }
            } else {
                alert('üö® Voice recognition not supported in this browser');
            }
        }
        
        function toggleMultiDestination() {
            multiDestMode = !multiDestMode;
            const panel = document.getElementById('multiDestPanel');
            const btn = document.getElementById('multiDestBtn');
            
            if (multiDestMode) {
                panel.style.display = 'block';
                btn.innerHTML = '‚ùå Close Multi';
                btn.style.background = 'linear-gradient(45deg, #f44336, #d32f2f)';
                updateStatusIndicator('üó∫Ô∏è Multi-destination mode activated', '#673ab7');
            } else {
                panel.style.display = 'none';
                btn.innerHTML = 'üó∫Ô∏è Multi';
                btn.style.background = 'linear-gradient(45deg, #673ab7, #512da8)';
                updateStatusIndicator('üó∫Ô∏è Multi-destination mode deactivated', '#6c757d');
            }
        }
        
        function openAIPlanner() {
            const panel = document.getElementById('aiPlannerPanel');
            panel.style.display = 'block';
            updateStatusIndicator('ü§ñ AI Trip Planner activated', '#00bcd4');
        }
        
        function closePanel(panelId) {
            document.getElementById(panelId).style.display = 'none';
            if (panelId === 'multiDestPanel') {
                multiDestMode = false;
                document.getElementById('multiDestBtn').innerHTML = 'üó∫Ô∏è Multi';
                document.getElementById('multiDestBtn').style.background = 'linear-gradient(45deg, #673ab7, #512da8)';
            }
            updateStatusIndicator('üõ∞Ô∏è Panel closed', '#6c757d');
        }
        
        // Premium Map Features
        function trackLocation() {
            if (navigator.geolocation) {
                updateStatusIndicator('üì° Live tracking activated', '#4CAF50');
                navigator.geolocation.watchPosition(function(position) {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    console.log(`üì° Live position: ${lat}, ${lng}`);
                    // Update map with live position
                }, function(error) {
                    updateStatusIndicator('üö® Live tracking failed', '#f44336');
                });
                alert('üì° Live location tracking activated!\nYour position will be updated in real-time.');
            } else {
                alert('üö® Live tracking not supported');
            }
        }
        
        function optimizeRoute() {
            updateStatusIndicator('‚ö° Optimizing route with AI...', '#ffa500');
            setTimeout(() => {
                updateStatusIndicator('‚ö° Route optimized! 23% faster, 15% fuel savings', '#4CAF50');
                alert('‚ö° Premium Route Optimization Complete!\n\n‚úÖ 23% faster route found\n‚úÖ 15% fuel savings\n‚úÖ Avoiding 3 traffic bottlenecks\n‚úÖ Weather-optimized path');
            }, 2000);
        }
        
        function shareLocation() {
            if (navigator.share) {
                navigator.share({
                    title: 'My Location - Mars Maps Premium',
                    text: 'Check out my location!',
                    url: window.location.href
                });
            } else {
                // Fallback for browsers without native sharing
                const shareUrl = window.location.href;
                navigator.clipboard.writeText(shareUrl);
                alert('üì§ Location link copied to clipboard!\n\nShare with friends and family.');
            }
            updateStatusIndicator('üì§ Location shared successfully', '#4CAF50');
        }
        
        function offlineMode() {
            updateStatusIndicator('üì± Preparing offline maps...', '#ffa500');
            setTimeout(() => {
                updateStatusIndicator('üì± Offline mode ready! Maps cached for 50km radius', '#4CAF50');
                alert('üì± Offline Mode Activated!\n\n‚úÖ Maps cached for 50km radius\n‚úÖ Navigation works without internet\n‚úÖ Points of interest saved\n‚úÖ Battery optimization enabled');
            }, 3000);
        }
        
        function weatherOverlay() {
            updateStatusIndicator('üå§Ô∏è Loading weather data...', '#ffa500');
            setTimeout(() => {
                updateStatusIndicator('üå§Ô∏è Weather overlay active - Clear skies, 22¬∞C', '#4CAF50');
                alert('üå§Ô∏è Weather Integration Active!\n\nüå°Ô∏è Current: 22¬∞C, Clear\nüåßÔ∏è Rain expected in 3 hours\nüí® Wind: 15 km/h NE\n‚òÄÔ∏è UV Index: 6 (High)');
            }, 1500);
        }
        
        function trafficLive() {
            updateStatusIndicator('üö¶ Analyzing live traffic...', '#ffa500');
            setTimeout(() => {
                updateStatusIndicator('üö¶ Live traffic: Heavy congestion on Route 101', '#ff9800');
                alert('üö¶ Live Traffic Analysis!\n\nüî¥ Heavy: Route 101 (15 min delay)\nüü° Moderate: Highway 85 (5 min delay)\nüü¢ Clear: Alternative routes available\n‚ö° Recommending fastest alternate path');
            }, 2000);
        }
        
        // Premium AI Features
        function optimizedTrip() {
            updateStatusIndicator('‚ö° AI calculating optimal route...', '#00bcd4');
            setTimeout(() => {
                updateStatusIndicator('‚ö° AI found 3 optimized routes with 27% time savings', '#4CAF50');
                alert('‚ö° AI Trip Optimization Complete!\n\nüéØ Route 1: Fastest (27% time savings)\n‚õΩ Route 2: Most fuel efficient (35% savings)\nüå± Route 3: Eco-friendly (40% CO2 reduction)\n\nRecommended: Route 1 for your preferences');
                closePanel('aiPlannerPanel');
            }, 3000);
        }
        
        function smartRecommendations() {
            updateStatusIndicator('üß† AI analyzing preferences...', '#00bcd4');
            setTimeout(() => {
                updateStatusIndicator('üß† Smart recommendations generated', '#4CAF50');
                alert('üß† AI Smart Recommendations!\n\n‚òï Coffee shop 2 min from route\n‚õΩ Cheapest gas station ahead\nüçï Highly-rated restaurant nearby\nüè® Hotel deals on your route\nüéØ Based on your travel history');
                closePanel('aiPlannerPanel');
            }, 2500);
        }
        
        function predictiveTraffic() {
            updateStatusIndicator('üîÆ Predicting future traffic patterns...', '#00bcd4');
            setTimeout(() => {
                updateStatusIndicator('üîÆ Traffic prediction: Congestion in 45 minutes', '#ff9800');
                alert('üîÆ Predictive Traffic Analysis!\n\nüìà Traffic will increase 40% in 45 min\nüöß Construction starts tomorrow 9 AM\n‚è∞ Best departure time: Now or after 7 PM\nüõ£Ô∏è Alternative route suggested');
                closePanel('aiPlannerPanel');
            }, 2000);
        }
        
        function weatherIntegration() {
            updateStatusIndicator('üå§Ô∏è Integrating weather into route planning...', '#00bcd4');
            setTimeout(() => {
                updateStatusIndicator('üå§Ô∏è Weather-optimized route planned', '#4CAF50');
                alert('üå§Ô∏è Weather-Aware Route Planning!\n\nüåßÔ∏è Avoiding rain zone (starts in 2 hours)\n‚ùÑÔ∏è No ice warnings on suggested route\nüí® Tailwind will reduce travel time 8%\n‚òÄÔ∏è Clear skies for 95% of journey');
                closePanel('aiPlannerPanel');
            }, 2500);
        }
        
        // Multi-destination functions
        function addDestination() {
            const list = document.getElementById('destinationList');
            const count = list.children.length + 1;
            const newInput = document.createElement('div');
            newInput.style.marginBottom = '10px';
            newInput.innerHTML = `<input type="text" placeholder="üåü Destination ${count}" style="width: 100%; padding: 10px; border-radius: 10px; border: 1px solid #FFD700; background: rgba(0,0,0,0.7); color: white;">`;
            list.appendChild(newInput);
            updateStatusIndicator(`‚ûï Destination ${count} added`, '#4CAF50');
        }
        
        function planMultiRoute() {
            const inputs = document.querySelectorAll('#destinationList input');
            destinations = Array.from(inputs).map(input => input.value).filter(val => val.trim());
            
            if (destinations.length < 2) {
                alert('üö® Please enter at least 2 destinations');
                return;
            }
            
            updateStatusIndicator('üó∫Ô∏è Planning multi-destination route...', '#673ab7');
            setTimeout(() => {
                updateStatusIndicator(`üó∫Ô∏è Multi-route planned for ${destinations.length} destinations`, '#4CAF50');
                alert(`üó∫Ô∏è Multi-Destination Route Planned!\n\nüìç ${destinations.length} destinations optimized\n‚ö° Total time: 3h 45min\n‚õΩ Fuel cost: $47\nüéØ Most efficient order calculated\n\nRoute optimization saved 1h 15min!`);
                closePanel('multiDestPanel');
                multiDestMode = false;
                document.getElementById('multiDestBtn').innerHTML = 'üó∫Ô∏è Multi';
                document.getElementById('multiDestBtn').style.background = 'linear-gradient(45deg, #673ab7, #512da8)';
            }, 3000);
        }
        
        function showAnalytics() {
            const panel = document.getElementById('analyticsPanel');
            panel.style.display = 'block';
            updateStatusIndicator('üìä Loading travel analytics...', '#ff9800');
            
            // Simulate loading analytics data
            setTimeout(() => {
                updateStatusIndicator('üìä Analytics loaded - Premium insights available', '#4CAF50');
            }, 1000);
        }
        
        // Initialize stars
        createStars();
        
        // Auto-press "Find Me" when page loads
        window.addEventListener('load', function() {
            setTimeout(() => {
                findLocation();
                updateStatusIndicator('üìç Finding your location...', '#ffa500');
            }, 1000); // Small delay to ensure page is fully loaded
        });
        
        // Add some Mars-themed console messages
        console.log('ü™ê Mars Maps Navigation Helper Activated');
        console.log('üõ∞Ô∏è Embedded navigation system ready');
        console.log('üìç Auto-locating your position...');
        console.log('üó∫Ô∏è Use the controls to explore different map modes');
    </script>
</body>
</html>

